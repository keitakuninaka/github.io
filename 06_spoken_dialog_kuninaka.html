<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>初音ミクの音声対話</title>
</head>
<body>
    <h1>初音ミクの音声対話</h1>
    
    <div id="conversation"></div>
    <button onclick="startListening()">音声入力開始</button>
    <button onclick="stopListening()">音声入力停止</button>
    
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=GqGVPyEy"></script>
    <script>
        // 初音ミクの音声で応答を再生する関数
        function speakMikuResponse(response) {
            responsiveVoice.speak(response, "Japanese Female");
        }
        
        // ユーザーの入力を処理する関数
        function processUserInput(userInput) {
            // 応答生成ロジックを実装する
            // 例えば、ランダムな応答を返す場合は以下のようにする
            const responses = [
                "こんにちは！",
                "どういたしまして！",
                "ごめんなさい、よくわかりません…"
            ];
            const randomIndex = Math.floor(Math.random() * responses.length);
            const mikuResponse = responses[randomIndex];
            
            // ユーザーの入力を表示
            const userMessage = document.createElement("p");
            userMessage.innerHTML = "ユーザー: " + userInput;
            document.getElementById("conversation").appendChild(userMessage);
            
            // 初音ミクの応答を表示
            const mikuMessage = document.createElement("p");
            mikuMessage.innerHTML = "初音ミク: " + mikuResponse;
            document.getElementById("conversation").appendChild(mikuMessage);
            
            // 初音ミクの応答を音声で再生
            speakMikuResponse(mikuResponse);
        }
        
       // 音声入力を開始する関数
        function startListening() {
            recognition = new webkitSpeechRecognition(); // Chrome用にプレフィックスを付ける
            recognition.lang = "ja-JP"; // 認識する言語を日本語に設定
            recognition.continuous = true; // 連続的に音声を認識する
            
            recognition.onresult = function(event) {
                const userInput = event.results[event.results.length - 1][0].transcript;
                processUserInput(userInput);
            };
            
            recognition.start(); // 音声認識を開始
        }
        
        // 音声入力を停止する関数
        function stopListening() {
            recognition.stop(); // 音声認識を停止
        }
    </script>
</body>
</html>
